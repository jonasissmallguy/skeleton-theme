{% comment %}
Full-width breakout: 50% image (left) with text overlay, 50% product grid (right)
{% endcomment %}

<div class="collection-section-wrapper">
  <section class="full-width-collection-section">
    {% assign collection = collections[section.settings.collection] %}

    <div class="collection-columns">

      <!-- LEFT SIDE: Fullscreen Image with Overlay -->
      <div class="collection-left">
        {% if section.settings.custom_image != blank and collection %}
          <a href="{{ collection.url }}" class="collection-image-link">
            <div class="image-wrapper">
              <img
                src="{{ section.settings.custom_image | image_url: width: 2000 }}"
                alt="{{ section.settings.overlay_heading | escape }}"
                class="main-image"
              >
              <div
                class="overlay"
                style="
                  top: {{ section.settings.overlay_top }}%;
                  left: {{ section.settings.overlay_left }}%;
                  color: {{ section.settings.overlay_color }};
                "
              >
                {% if section.settings.overlay_heading %}
                  <h2 style="font-size: {{ section.settings.overlay_heading_size }}px;">
                    {{ section.settings.overlay_heading }}
                  </h2>
                {% endif %}
                {% if section.settings.overlay_subheading %}
                  <p style="font-size: {{ section.settings.overlay_subheading_size }}px;">
                    {{ section.settings.overlay_subheading }}
                  </p>
                {% endif %}
                {% if section.settings.button_label %}
                  <a href="{{ collection.url }}" class="overlay-button">{{ section.settings.button_label }}</a>
                {% endif %}
              </div>
            </div>
          </a>
        {% endif %}
      </div>

      <!-- RIGHT SIDE: 4 Product Tiles -->
      <div class="collection-right">
        {% if collection.products.size > 0 %}
          {% for product in collection.products limit: 4 %}
            <div class="product-cell">
              <a href="{{ product.url }}">
                <img src="{{ product.featured_image | img_url: '800x' }}" alt="{{ product.title | escape }}">
              </a>
            </div>
          {% endfor %}
        {% else %}
          <p>No products in this collection.</p>
        {% endif %}
      </div>

    </div>
  </section>
</div>

<style>
html, body {
  margin: 0;
  padding: 0;
}

* {
  box-sizing: border-box;
}

/* Break out of Shopify theme wrappers */
.collection-section-wrapper {
  width: 100vw;
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;
}

/* Section layout */
.full-width-collection-section {
  margin: 0;
  padding: 0;
  width: 100vw;
  background-color: #FFFCEE;
  overflow: hidden;
}

.collection-columns {
  display: flex;
  flex-wrap: nowrap;
  width: 100vw;
  height: 100vh;
}

/* LEFT COLUMN: Image */
.collection-left {
  width: 50vw;
  height: 100vh;
}

.image-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
}

.main-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* Overlay styling */
.overlay {
  position: absolute;
  max-width: 90%;
  text-align: left;
  text-shadow: 0 1px 3px rgba(0,0,0,0.4);
}

.overlay h2,
.overlay p {
  margin: 0 0 10px;
}

.overlay-button {
  display: inline-block;
  padding: 10px 20px;
  background-color: black;
  color: white;
  border-radius: 6px;
  text-decoration: none;
  font-weight: 600;
  transition: background-color 0.3s ease;
}

.overlay-button:hover {
  background-color: #333;
}

/* RIGHT COLUMN: 2x2 Grid, no spacing */
.collection-right {
  width: 50vw;
  height: 100vh;
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  gap: 0;
}

.product-cell {
  width: 100%;
  height: 100%;
}

.product-cell img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
</style>

{% schema %}
{
  "name": "Full Width Collection",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Main Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image",
      "label": "Custom Collection Image"
    },
    {
      "type": "text",
      "id": "overlay_heading",
      "label": "Overlay Heading",
      "default": "Our Featured Collection"
    },
    {
      "type": "number",
      "id": "overlay_heading_size",
      "label": "Heading Font Size (px)",
      "default": 36
    },
    {
      "type": "text",
      "id": "overlay_subheading",
      "label": "Overlay Subheading",
      "default": "Discover handpicked products"
    },
    {
      "type": "number",
      "id": "overlay_subheading_size",
      "label": "Subheading Font Size (px)",
      "default": 18
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "overlay_top",
      "label": "Overlay Top Position (%)",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 30
    },
    {
      "type": "range",
      "id": "overlay_left",
      "label": "Overlay Left Position (%)",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 30
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Shop Now"
    }
  ],
  "presets": [
    {
      "name": "Full Width Collection Section"
    }
  ]
}
{% endschema %}
